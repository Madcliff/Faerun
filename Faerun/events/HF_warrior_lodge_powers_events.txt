# Written by Flavio (HF.25000 - HF.25071)

namespace = HF

#############################################
## Power 2: Summon Commander
character_event = {
    id = HF.25000
    desc = EVTDESCHFA25000
    picture = GFX_evt_viking_battle_oldgods

    border = GFX_event_normal_frame_war

    is_triggered_only = yes
    
	option = {
		name = EVTOPTCHF25000
		
		trigger = {
			OR = { 
				NOT = { ROOT = { has_law = succ_byzantine_elective } }  #Either not Imperial...
				NOT = { #...Or there are no valid vassal candidates that can be commanders.
					any_vassal = { 
						higher_real_tier_than = BARON
						NOT = { 
							primary_title = { temporary = yes } 
						}
						OR = {
							AND = {
								OR = {
									male_can_hold_minor_title_trigger = yes
									female_can_hold_minor_commander_title_trigger = yes
								}
								is_adult = yes
							}
							has_character_flag = special_marshal
						}
				
						prisoner = no
						NOT = { trait = incapable }
						NOT = { is_inaccessible_trigger = yes }
						NOT = { has_character_flag = guru }
						NOT = { has_character_modifier = refusing_to_lead }
						NOR = {
							has_job_title = job_chancellor
							has_job_title = job_marshal
							has_job_title = job_treasurer
							has_job_title = job_spymaster
							has_job_title = job_spiritual
							has_minor_title = title_commander
						}
					} 
				}
			}
			any_realm_character = {
				NOT = {
					higher_tier_than = BARON
				}
				liege = { character = ROOT }
				has_minor_title = title_commander
				NOT = {
					martial = 10
				}
			}
			OR = {
				AND = {
					tier = COUNT
					any_realm_character = {
						count = 2
						liege = { character = ROOT }
						has_minor_title = title_commander
					}
				}
				AND = {
					tier = DUKE
					any_realm_character = {
						count = 4
						liege = { character = ROOT }
						has_minor_title = title_commander
					}
				}
				AND = {
					tier = KING
					is_nomadic = no
					any_realm_character = {
						count = 6
						liege = { character = ROOT }
						has_minor_title = title_commander
					}
				}
				AND = {
					tier = EMPEROR
					is_nomadic = no
					any_realm_character = {
						count = 8
						liege = { character = ROOT }
						has_minor_title = title_commander
					}
				}
				AND = {
					tier = KING
					is_nomadic = yes
					any_realm_character = {
						count = 2
						liege = { character = ROOT }
						has_minor_title = title_commander
					}
				}
				AND = {
					tier = EMPEROR
					is_nomadic = yes
					any_realm_character = {
						count = 4
						liege = { character = ROOT }
						has_minor_title = title_commander
					}
				}
			}
		}
		
		random_realm_character = {
			limit = {
				NOT = {
					higher_tier_than = BARON
				}
				liege = { character = ROOT }
				has_minor_title = title_commander
				NOT = {
					martial = 12
				}
			}
			opinion = {
				modifier = insulted
				who = ROOT
				years = 2
			}
			remove_title = title_commander
		}
		
		event_target:invited_lodge_soldier = {
			show_scope_change = no
			opinion = {
				modifier = opinion_loyal_servant
				who = ROOT
				years = 10
			}
			give_minor_title = title_commander
		}
	}
    option = {
        name = EVTOPTAHF25000
        trigger = {
			OR = { 
				NOT = { ROOT = { has_law = succ_byzantine_elective } }  #Either not Imperial...
				NOT = { #...Or there are no valid vassal candidates that can be commanders.
					any_vassal = { 
						higher_real_tier_than = BARON
						NOT = { 
							primary_title = { temporary = yes } 
						}
						OR = {
							AND = {
								OR = {
									male_can_hold_minor_title_trigger = yes
									female_can_hold_minor_commander_title_trigger = yes
								}
								is_adult = yes
							}
							has_character_flag = special_marshal
						}
				
						prisoner = no
						NOT = { trait = incapable }
						NOT = { is_inaccessible_trigger = yes }
						NOT = { has_character_flag = guru }
						NOT = { has_character_modifier = refusing_to_lead }
						NOR = {
							has_job_title = job_chancellor
							has_job_title = job_marshal
							has_job_title = job_treasurer
							has_job_title = job_spymaster
							has_job_title = job_spiritual
							has_minor_title = title_commander
						}
					} 
				}
			}
            OR = {
                AND = {
                    tier = COUNT
                    NOT = {
                        any_realm_character = {
                            count = 2
                            liege = { character = ROOT }
                            has_minor_title = title_commander
                        }
                    }
                }
                AND = {
                    tier = DUKE
                    NOT = {
                        any_realm_character = {
                            count = 4
                            liege = { character = ROOT }
                            has_minor_title = title_commander
                        }
                    }
                }
                AND = {
                    tier = KING
                    is_nomadic = no
                    NOT = {
                        any_realm_character = {
                            count = 6
                            liege = { character = ROOT }
                            has_minor_title = title_commander
                        }
                    }
                }
                AND = {
                    tier = EMPEROR
                    is_nomadic = no
                    NOT = {
                        any_realm_character = {
                            count = 8
                            liege = { character = ROOT }
                            has_minor_title = title_commander
                        }
                    }
                }
                AND = {
                    tier = KING
                    is_nomadic = yes
                    NOT = {
                        any_realm_character = {
                            count = 2
                            liege = { character = ROOT }
                            has_minor_title = title_commander
                        }
                    }
                }
                AND = {
                    tier = EMPEROR
                    is_nomadic = yes
                    NOT = {
                        any_realm_character = {
                            count = 4
                            liege = { character = ROOT }
                            has_minor_title = title_commander
                        }
                    }
                }
            }
        }
        
        event_target:invited_lodge_soldier = {
			show_scope_change = no
            opinion = {
                modifier = opinion_loyal_servant
                who = ROOT
                years = 10
            }
            give_minor_title = title_commander
        }
    }
    option = {
        name = EVTOPTBHF25000
        event_target:invited_lodge_soldier = { 
            show_scope_change = no
            opinion = {
                modifier = opinion_loyal_servant
                who = ROOT
                years = 10
            }
        }
        ai_chance = {    
            factor = 100
        }
    }
}
#############################################
## Power 3: Summon Warriors of Ukko - removed

#############################################
## Power 2: Call of the Steppe - removed

#Zun Battle trance. - removed

#############################################
## Power 2: Slavic Stand Together. - removed


####################################################################

#On_start: setup event for scarred traits visuals and variable.
character_event = {
	id = HF.25020
	hide_window = yes

	is_triggered_only = yes

	trigger = { 
		is_save_game = no
		OR = { 
			trait = scarred
			trait = scarred_mid
			trait = scarred_high
		}
	}
	immediate = {
		add_scarred_start_effect = yes
	}
}

#War Sacrifice power.
character_event = {
	id = HF.25021
	desc = {
		trigger = {
			religion_group = pagan_group
		}
		text = EVTDESCAHF25021
	}
	desc = {
		trigger = { 
			NOT = {
				religion_group = pagan_group
			}
		}
		text = EVTDESCBHF25021
	}
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion
	hide_new = yes

	is_triggered_only = yes

	immediate = {
		hidden_effect = {
			random_dynasty_member = {
				limit = {
					is_ruler = no
					is_adult = yes
					host = { character = ROOT }
					NOT = { is_heir = ROOT }
				}
				save_event_target_as = scoped_war_sacrifice
			}
			random_courtier = { 
				limit = {
					NOT = { dynasty = ROOT }
					is_ruler = no 
					is_adult = yes 
					is_alive = yes 
				} 
				preferred_limit = {
					is_unimportant_trigger = yes
				}
				save_event_target_as = sacrificed_courtier
			}
			clr_character_flag = flag_painted_by_uthgardt #Safety cleanup
			#Bon and Hellenics would not paint their faces. They only get the blood splatter effect when sacrificing. Flags only used for localization.
			if = {
				limit = { 
					society_member_of = warrior_lodge_uthgardt		#Tie to flag to avoid potential multiplayer delay issues.
				}
				set_character_flag = flag_painted_by_uthgardt
			}
		}
	}
	option = { #Sacrifice family member
		name = EVTOPTAHF25021
		trigger = { 
			event_target:scoped_war_sacrifice = { is_alive = yes } 
			OR = { 
				religion = uthgardt_faith
				religion = deities_of_fury
				has_religion_feature = religion_ritual_sacrifice
			} 
		}
		add_character_modifier = { 
			modifier = lodge_war_sacrifice_4
			years = 5 
		}
		add_blood_splatter_effect = yes
		event_target:scoped_war_sacrifice = { 
			show_scope_change = no
			save_event_target_as = kinslayer_target
			death = { 
				death_reason = death_execution_aztec_sacrifice 
				killer = ROOT
			} 
		} 
		add_kinslayer_trait_effect = yes
		pacifists_lose_piety_effect = yes
		hidden_tooltip = { character_event = { id = HF.25022 } } 
		hidden_tooltip = {
			clr_character_flag = flag_picking_war_sacrifice
			add_character_modifier = { 
				modifier = lodge_war_sacrifice_cooldown
				years = 10
				hidden = yes
			}
			event_target:scoped_war_sacrifice = {
				mother = {
					opinion = {
						modifier = opinion_killed_close_kin
						who = ROOT
					}
				}
				father = {
					opinion = {
						modifier = opinion_killed_close_kin
						who = ROOT
					}
				}
				spouse = {
					opinion = {
						modifier = opinion_spouse_slayer
						who = ROOT
					}
				}
				any_child = {
					opinion = {
						modifier = opinion_killed_close_kin
						who = ROOT
					}
				}
			}
		}
	}
	option = { #Sacrifice servant
		name = EVTOPTBHF25021
		trigger = { 
			any_courtier = {
				NOT = { dynasty = ROOT }
				is_ruler = no 
				is_adult = yes 
				is_alive = yes 
			} 
			OR = { 
				religion = uthgardt_faith 
				religion = deities_of_fury
				has_religion_feature = religion_ritual_sacrifice
			} 
		}
		add_character_modifier = { 
			modifier = lodge_war_sacrifice_3
			years = 5 
		}
		event_target:sacrificed_courtier = { 
			show_scope_change = no
			death = { 
				death_reason = death_execution_aztec_sacrifice 
				killer = ROOT
			} 
		} 
		custom_tooltip = { 
			text = tooltip_EVTOPTBHF25021
			hidden_tooltip = { 
				any_courtier_or_vassal = {
					limit = {
						NOR = {
							trait = impaler
							trait = cruel
							is_member_of_any_warrior_lodge_trigger = yes
						} 
					}
					opinion = {
						who = ROOT
						modifier = opinion_savage_butcher
						years = 5
					}
				}
				event_target:scoped_war_sacrifice = {
					mother = {
						opinion = {
							modifier = opinion_killed_close_kin
							who = ROOT
						}
					}
					father = {
						opinion = {
							modifier = opinion_killed_close_kin
							who = ROOT
						}
					}
					spouse = {
						opinion = {
							modifier = opinion_spouse_slayer
							who = ROOT
						}
					}
					any_child = {
						opinion = {
							modifier = opinion_killed_close_kin
							who = ROOT
						}
					}
				}
			} 
		} 
		pacifists_lose_piety_effect = yes
		add_blood_splatter_effect = yes
		hidden_tooltip = { character_event = { id = HF.25023 } } 
		hidden_tooltip = {
			clr_character_flag = flag_picking_war_sacrifice
			add_character_modifier = { 
				modifier = lodge_war_sacrifice_cooldown
				years = 10
				hidden = yes
			}
		}
	}
	option = { #Sacrifice livestock
		name = {
			text = EVTOPTCHF25021_A
			trigger = {
				is_nomadic = no
			}
		}
		name = {
			text = EVTOPTCHF25021_B
			trigger = {
				is_nomadic = yes
			}
		}
		add_character_modifier = { 
			modifier = lodge_war_sacrifice_2
			years = 5 
		}
		if = { 
			limit = { ai = no is_nomadic = no }
			scaled_wealth = { value = -0.75 min = -50 max = -150 } 
		}
		if = { 
			limit = { ai = no is_nomadic = yes }
			manpower = -150
		}
		if = { 
			limit = { NOR = { religion_group = pagan_group has_religion_feature = religion_ritual_sacrifice } }
			tiered_high_piety_negative_effect = yes 
		}
		add_blood_splatter_effect = yes
		hidden_tooltip = { character_event = { id = HF.25024 } } 
		hidden_tooltip = {
			clr_character_flag = flag_picking_war_sacrifice
			add_character_modifier = { 
				modifier = lodge_war_sacrifice_cooldown
				years = 10
				hidden = yes
			}
		}
	}
	option = { #Never mind.
		name = EVTOPTEHF25021
		trigger = { ai = no }
		add_society_currency_medium_effect = yes
		clr_character_flag = flag_picking_war_sacrifice
	}
#	option = { #Sacrifice wealth
#		name = EVTOPTDHF25021
#		if = { 
#			limit = { ai = no }
#			scaled_wealth = { value = -0.25 min = -25 max = -75 } 
#		}
#		if = { 
#			limit = { NOT = { religion_group = pagan_group } }
#			tiered_piety_negative_effect = yes 
#		}
#		hidden_tooltip = { character_event = { id = HF.25025 } } 
#		add_character_modifier = { 
#			modifier = lodge_war_sacrifice_1
#			years = 5 
#		}
#	}
}

#Sacrificed relative to the gods.
character_event = {
	id = HF.25022
	desc = {
		trigger = {
			has_character_flag = flag_painted_by_uthgardt
		}
		text = EVTDESCAHF25022
		picture = GFX_evt_midwinter_blot_oldgods
	}
	hide_new = yes

	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	immediate = { #Tattoos/warpaint assignment is tiered, depending on the sacrifice performed. Tattoos can only be applied once.
		random_list = { 
			33 = { sound_effect = sacrifice_family_01 } 
			33 = { sound_effect = sacrifice_family_02 } 
			33 = { sound_effect = sacrifice_family_03 } 
		}
		if = { 
			limit = { 
				has_character_flag = flag_painted_by_uthgardt
				NOR = { 
					trait = norse_tattoo_1
					trait = norse_tattoo_2
					trait = norse_tattoo_3
					trait = norse_tattoo_4
					trait = norse_tattoo_5
					trait = norse_tattoo_6
				}
			}
			random_list = { 
				50 = { add_trait = norse_tattoo_5 }
				50 = { add_trait = norse_tattoo_6 } 
			}
		}
	}

	option = { 
		name = EVTOPTAHF25022
		clr_character_flag = flag_painted_by_uthgardt # Flag cleanup
	}
}

#Sacrificed courtier to the gods.
character_event = {
	id = HF.25023
	desc = {
		trigger = {
			has_character_flag = flag_painted_by_uthgardt
		}
		text = EVTDESCAHF25023
		picture = GFX_evt_midwinter_blot_oldgods
	}
	hide_new = yes

	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	immediate = { #Tattoos/warpaint assignment is tiered, depending on the sacrifice performed. Tattoos can only be applied once.
		random_list = { 
			33 = { sound_effect = sacrifice_family_01 } 
			33 = { sound_effect = sacrifice_family_02 } 
			33 = { sound_effect = sacrifice_family_03 } 
		}
		if = { 
			limit = { 
				has_character_flag = flag_painted_by_uthgardt
				NOR = { 
					trait = norse_tattoo_1
					trait = norse_tattoo_2
					trait = norse_tattoo_3
					trait = norse_tattoo_4
					trait = norse_tattoo_5
					trait = norse_tattoo_6
				}
			}
			random_list = { 
				50 = { add_trait = norse_tattoo_3 }
				50 = { add_trait = norse_tattoo_4 } 
			}
		}
	}

	option = { 
		name = EVTOPTAHF25023
		clr_character_flag = flag_painted_by_uthgardt # Flag cleanup
	}
}

#Sacrificed cattle to the gods.
character_event = {
	id = HF.25024
	desc = {
		trigger = {
			is_nomadic = no
		}
		text = EVTDESCAHF25024
	}
	desc = {
		trigger = {
			is_nomadic = yes
		}
		text = EVTDESCBHF25024
	}

	hide_new = yes
	picture = GFX_evt_religious_exultation
	border = GFX_event_normal_frame_religion

	is_triggered_only = yes

	immediate = { #Tattoos/warpaint assignment is tiered, depending on the sacrifice performed. Tattoos can only be applied once.
		random_list = { 
			33 = { sound_effect = sacrifice_cattle_01 } 
			33 = { sound_effect = sacrifice_cattle_02 } 
			33 = { sound_effect = sacrifice_cattle_03 } 
		}
		if = { 
			limit = { 
				has_character_flag = flag_painted_by_norse 
				NOR = { 
					trait = norse_tattoo_1
					trait = norse_tattoo_2
					trait = norse_tattoo_3
					trait = norse_tattoo_4
					trait = norse_tattoo_5
					trait = norse_tattoo_6
				}
			}
			random_list = { 
				50 = { add_trait = norse_tattoo_1 }
				50 = { add_trait = norse_tattoo_2 } 
			}
		}
	}

	option = { 
		name = EVTOPTAHF25024
		clr_character_flag = flag_painted_by_uthgardt # Flag cleanup
	}
}

#Sacrificed wealth to the gods. - REMOVED
#character_event = {
#	id = HF.25025
#	desc = EVTDESCAHF25025
#
#	hide_new = yes
#	picture = GFX_evt_religious_exultation
#	border = GFX_event_normal_frame_religion
#
#	is_triggered_only = yes
#
#	immediate = { #Tattoos/warpaint assignment is tiered, depending on the sacrifice performed. Tattoos can only be applied once.
#		if = { 
#			limit = { 
#				has_character_flag = flag_painted_by_norse 
#				NOR = { 
#					trait = norse_tattoo_1
#					trait = norse_tattoo_2
#					trait = norse_tattoo_3
#					trait = norse_tattoo_4
#					trait = norse_tattoo_5
#					trait = norse_tattoo_6
#				}
#			}
#			random_list = { 
#				50 = { add_trait = norse_tattoo_1 }
#				50 = { add_trait = norse_tattoo_2 } 
#			}
#		}
#		if = { 
#			limit = { 
#				has_character_flag = flag_painted_by_west_african
#				NOR = { 
#					trait = african_tattoo_1
#					trait = african_tattoo_2
#					trait = african_tattoo_3
#					trait = african_tattoo_4
#					trait = african_tattoo_5
#					trait = african_tattoo_6
#					trait = african_tattoo_7
#					trait = african_tattoo_8
#				}
#			}
#			random_list = { 
#				50 = { add_trait = african_tattoo_1 }
#				50 = { add_trait = african_tattoo_2 } 
#			}
#		}
#		if = { 
#			limit = { 
#				OR = { 
#					has_character_flag = flag_painted_by_slavic
#					has_character_flag = flag_painted_by_baltic
#				}
#				NOR = { 
#					trait = slavic_tattoo_1
#					trait = slavic_tattoo_2
#					trait = slavic_tattoo_3
#					trait = slavic_tattoo_4
#					trait = slavic_tattoo_5
#					trait = slavic_tattoo_6
#				}
#			}
#			random_list = { 
#				50 = { add_trait = slavic_tattoo_1 }
#				50 = { add_trait = slavic_tattoo_2 } 
#			}
#		}
#		if = { 
#			limit = { 
#				has_character_flag = flag_painted_by_tengri
#			}
#			remove_character_modifier = tengri_warpaint_1 #Remove all previous paint that might still be lingering, for whatever reason.
#			remove_character_modifier = tengri_warpaint_2
#			remove_character_modifier = aztec_warpaint_1
#			remove_character_modifier = aztec_warpaint_2
#			remove_character_modifier = finnish_warpaint_1
#			remove_character_modifier = finnish_warpaint_2
#			remove_character_modifier = zun_warpaint_1
#			remove_character_modifier = zun_warpaint_2
#			random_list = { 
#				50 = { 
#					add_character_modifier = { 
#						modifier = tengri_warpaint_1
#						years = 5 
#						hidden = yes
#					}
#				}
#				50 = { 
#					add_character_modifier = { 
#						modifier = tengri_warpaint_2
#						years = 5 
#						hidden = yes
#					}
#				}
#			}
#		}
#		if = { 
#			limit = { 
#				has_character_flag = flag_painted_by_finnish
#			}
#			remove_character_modifier = tengri_warpaint_1 #Remove all previous paint that might still be lingering, for whatever reason.
#			remove_character_modifier = tengri_warpaint_2
#			remove_character_modifier = aztec_warpaint_1
#			remove_character_modifier = aztec_warpaint_2
#			remove_character_modifier = finnish_warpaint_1
#			remove_character_modifier = finnish_warpaint_2
#			remove_character_modifier = zun_warpaint_1
#			remove_character_modifier = zun_warpaint_2
#			random_list = { 
#				50 = { 
#					add_character_modifier = { 
#						modifier = finnish_warpaint_1
#						years = 5 
#						hidden = yes
#					}
#				}
#				50 = { 
#					add_character_modifier = { 
#						modifier = finnish_warpaint_2
#						years = 5 
#						hidden = yes
#					}
#				}
#			}
#		}
#		if = { 
#			limit = { 
#				has_character_flag = flag_painted_by_zun
#			}
#			remove_character_modifier = tengri_warpaint_1 #Remove all previous paint that might still be lingering, for whatever reason.
#			remove_character_modifier = tengri_warpaint_2
#			remove_character_modifier = aztec_warpaint_1
#			remove_character_modifier = aztec_warpaint_2
#			remove_character_modifier = finnish_warpaint_1
#			remove_character_modifier = finnish_warpaint_2
#			remove_character_modifier = zun_warpaint_1
#			remove_character_modifier = zun_warpaint_2
#			random_list = { 
#				50 = { 
#					add_character_modifier = { 
#						modifier = aztec_warpaint_1
#						years = 5 
#						hidden = yes
#					}
#				}
#				50 = { 
#					add_character_modifier = { 
#						modifier = aztec_warpaint_2
#						years = 5 
#						hidden = yes
#					}
#				}
#			}
#		}
#	}
#
#	option = { 
#		name = EVTOPTAHF25025
#		clr_character_flag = flag_painted_by_norse # Flag cleanup
#		clr_character_flag = flag_painted_by_tengri
#		clr_character_flag = flag_painted_by_baltic
#		clr_character_flag = flag_painted_by_finnish
#		clr_character_flag = flag_painted_by_slavic
#		clr_character_flag = flag_painted_by_west_african
#		clr_character_flag = flag_painted_by_zun
#		clr_character_flag = flag_painted_by_bon
#		clr_character_flag = flag_painted_by_hellenic
#	}
#}

##################################################################
#Hellenic Warrior Lodge has been recreated. - removed

####################################
#Call to Glory Power - First notification.
character_event = {
	id = HF.25030
	desc = EVTDESCHF25030
	picture = GFX_evt_viking_battle_oldgods
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	option = { 
		name = EVTOPTAHF25030
		custom_tooltip = { 
			text = TT_EVTOPTAHF25030
		}
		hidden_tooltip = { character_event = { id = HF.25031 days = 25 random = 5 } } #Hidden random list.
	}
}

#Main list
character_event = {
	id = HF.25031
	hide_window = yes

	is_triggered_only = yes

	immediate = { 
		random_list = { 
			30 = { 
				trigger = {
					in_command = yes
					is_at_sea = no
					war = yes
					has_character_modifier = call_to_glory
					is_member_of_any_warrior_lodge_trigger = yes
					society_rank = 4
					NOT = { check_variable = { which = "call_to_glory_variable" value = 20 } } #Stop after a while.
				}
				character_event = { id = HF.25032 } # Main reinforcement notification event.
			}
			50 = { 
				trigger = {
					OR = { 
						in_command = no
						is_at_sea = yes
					}
					war = yes
					has_character_modifier = call_to_glory
					is_member_of_any_warrior_lodge_trigger = yes
					society_rank = 4
					NOT = { check_variable = { which = "call_to_glory_variable" value = 20 } }
				}
				#If not in command, loop the event, just in case the player gets back into action.
				character_event = { id = HF.25031 days = 35 random = 5 }
			}
			100 = { 
				trigger = {
					OR = { 
						is_member_of_any_warrior_lodge_trigger = no
						war = no 
						AND = {
							is_member_of_any_warrior_lodge_trigger = yes
							NOT = { society_rank = 4 }
						}
						NOT = { has_character_modifier = call_to_glory }
					}
				}
				#If basic requirements for the power are no longer met, clean everything and stop the chain.
				remove_character_modifier = call_to_glory
				disband_event_forces = call_to_glory_disciplined
				disband_event_forces = call_to_glory_rowdy
				set_variable = { which = "call_to_glory_variable" value = 0 }
			}
			100 = { 
				trigger = {
					in_command = yes
					is_at_sea = no
					war = yes
					has_character_modifier = call_to_glory
					is_member_of_any_warrior_lodge_trigger = yes
					society_rank = 4
					check_variable = { which = "call_to_glory_variable" value = 20 }
				}
				character_event = { id = HF.25033 } #Once troops have spawned 20 times, they will stop spawning unless ruler succeeds in a persuasion check to lower the variable.
			}
			5 = { 
				trigger = {
					in_command = yes
					is_at_sea = no
					war = yes
					has_character_modifier = call_to_glory
					is_member_of_any_warrior_lodge_trigger = yes
					society_rank = 4
					has_earmarked_regiments = call_to_glory_rowdy #should have at least some rowdy troops.
					check_variable = { which = "call_to_glory_variable" value = 5 } #Shouldn't happen immediately after firing the power.

					NOT = { check_variable = { which = "call_to_glory_variable" value = 20 } } #Stop after a while.
				}
				character_event = { id = HF.25034 } # Rowdy troops are threatening to leave if they are not given more spoils.
			}
			5 = { 
				trigger = {
					in_command = yes
					is_at_sea = no
					war = yes
					has_character_modifier = call_to_glory
					is_member_of_any_warrior_lodge_trigger = yes
					society_rank = 4
					check_variable = { which = "call_to_glory_variable" value = 5 } #Shouldn't happen immediately after firing the power.
				}
				character_event = { id = HF.25037 } # Chance for either levy reinforcement bonus in capital, prestige, cheap troops, or raider ships.
			}
		}
	}
}

#Main reinforcement event.
character_event = {
	id = HF.25032
	desc = EVTDESCHF25032
	picture = GFX_evt_viking_battle_oldgods
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	notification = yes

	trigger = { 
		has_character_modifier = call_to_glory
		in_command = yes
		is_at_sea = no
		war = yes
		is_member_of_any_warrior_lodge_trigger = yes
		society_rank = 4
		NOT = { check_variable = { which = "call_to_glory_variable" value = 20 } }
	}

	fail_trigger_effect = { 
		if = { 
			limit = { 
				OR = { 
					is_member_of_any_warrior_lodge_trigger = no
					war = no 
					AND = {
						is_member_of_any_warrior_lodge_trigger = yes
						NOT = { society_rank = 4 }
					}
					NOT = { has_character_modifier = call_to_glory }
				}
			}
			#If basic requirements for the power are no longer met, clean everything and stop the chain.
			remove_character_modifier = call_to_glory
			disband_event_forces = call_to_glory_disciplined
			disband_event_forces = call_to_glory_rowdy
			set_variable = { which = "call_to_glory_variable" value = 0 }
			break = yes
		}
		if = { 
			limit = { 
				OR = { 
					in_command = no
					is_at_sea = yes
				}
				war = yes
				has_character_modifier = call_to_glory
			} 
			#If not in command, loop the event, just in case the player gets back into action.
			character_event = { id = HF.25031 days = 25 random = 5 }
		}
	}

	option = { 
		name = EVTOPTAHF25032
			#Norse Lodge: light_infantry + heavy_infantry 				150 + 100
			#Tengri Lodge: light_cavalry + horse_archers 				100 + 150
			#Slavic Lodge: light_infantry + light_cavalry 				200 + 50
			#Baltic Lodge: light_infantry + heavy_infantry + archers 	100 + 100 + 50
 			#Finnish Lodge: light_infantry + archers 					100 + 150
			#West-African Lodge: light_infantry + pikemen 				150 + 100
			#Zunist Lodge: pikemen + archers 							150 + 100
			#Bon Lodge: light_infantry + light_cavalry + archers 		100 + 50 + 100
			#Hellenic Lodge: pikemen + heavy infantry 					200 + 50

			#Numbers balanced based on realm size (30 or less, between 30 and 70, more than 70)
            if = { #Low spawn
            	limit = { society_member_of = warrior_lodge_uthgardt NOT = { realm_size = 30 } }
	            location = {
	                show_scope_change = no
	                ROOT = {
		                show_scope_change = no
	                    random_list = {  
		                    50 = { 
			                    spawn_unit = { 
			                        province = PREV
			                        owner = ROOT
			                        troops = { 
			                    		light_infantry = { 50 50 }
			                    		heavy_infantry = { 10 10 }
			                        }
			                        earmark = call_to_glory_disciplined
			                        attrition = 0
			                        merge = yes
			                        maintenance_multiplier = 0
				                    disband_on_peace = yes
			                  	}
		                  	}
		                    50 = { 
			                    spawn_unit = { 
			                        province = PREV
			                        owner = ROOT
			                        troops = { 
			                    		light_infantry = { 50 50 }
			                    		heavy_infantry = { 25 25 }
			                        }
			                        earmark = call_to_glory_rowdy #Might leave early on occasion.
			                        attrition = 0
			                        merge = yes
			                        maintenance_multiplier = 0
				                    disband_on_peace = yes
			                  	}
		                  	}
	                  	}
	                }
	            }
            }
            if = { #Mid spawn
            	limit = { society_member_of = warrior_lodge_uthgardt realm_size = 30 NOT = { realm_size = 70 } }
	            location = {
	                show_scope_change = no
	                ROOT = {
		                show_scope_change = no
	                    random_list = {  
		                    50 = { 
			                    spawn_unit = { 
			                        province = PREV
			                        owner = ROOT
			                        troops = { 
			                    		light_infantry = { 100 100 }
			                    		heavy_infantry = { 25 25 }
			                        }
			                        earmark = call_to_glory_disciplined
			                        attrition = 0
			                        merge = yes
			                        maintenance_multiplier = 0
				                    disband_on_peace = yes
			                  	}
		                  	}
		                    50 = { 
			                    spawn_unit = { 
			                        province = PREV
			                        owner = ROOT
			                        troops = { 
			                    		light_infantry = { 100 100 }
			                    		heavy_infantry = { 50 50 }
			                        }
			                        earmark = call_to_glory_rowdy #Might leave early on occasion.
			                        attrition = 0
			                        merge = yes
			                        maintenance_multiplier = 0
				                    disband_on_peace = yes
			                  	}
		                  	}
	                  	}
	                }
	            }
            }
            if = { #Top spawn
            	limit = { society_member_of = warrior_lodge_uthgardt realm_size = 70 }
	            location = {
	                show_scope_change = no
	                ROOT = {
		                show_scope_change = no
	                    random_list = {  
		                    50 = { 
			                    spawn_unit = { 
			                        province = PREV
			                        owner = ROOT
			                        troops = { 
			                    		light_infantry = { 150 150 }
			                    		heavy_infantry = { 50 50 }
			                        }
			                        earmark = call_to_glory_disciplined
			                        attrition = 0
			                        merge = yes
			                        maintenance_multiplier = 0
				                    disband_on_peace = yes
			                  	}
		                  	}
		                    50 = { 
			                    spawn_unit = { 
			                        province = PREV
			                        owner = ROOT
			                        troops = { 
			                    		light_infantry = { 200 200 }
			                    		heavy_infantry = { 100 100 }
			                        }
			                        earmark = call_to_glory_rowdy #Might leave early on occasion.
			                        attrition = 0
			                        merge = yes
			                        maintenance_multiplier = 0
				                    disband_on_peace = yes
			                  	}
		                  	}
	                  	}
	                }
	            }
            }

		hidden_tooltip = { 
			change_variable = { which = "call_to_glory_variable" value = 1 }
			character_event = { id = HF.25031 days = 35 random = 5 } #Hidden random list.
		}
	}
}

#Troop limit reached. What to do?
character_event = {
	id = HF.25033
	desc = EVTDESCHF25033
	picture = GFX_evt_viking_battle_oldgods
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	trigger = { 
		has_character_modifier = call_to_glory
		war = yes
		is_member_of_any_warrior_lodge_trigger = yes
		society_rank = 4
		NOT = { check_variable = { which = "call_to_glory_variable" value = 20 } }
	}

	fail_trigger_effect = { 
		if = { 
			limit = { 
				OR = { 
					is_member_of_any_warrior_lodge_trigger = no
					war = no 
					AND = {
						is_member_of_any_warrior_lodge_trigger = yes
						NOT = { society_rank = 4 }
					}
					NOT = { has_character_modifier = call_to_glory }
				}
			}
			#If basic requirements for the power are no longer met, clean everything and stop the chain.
			remove_character_modifier = call_to_glory
			disband_event_forces = call_to_glory_disciplined
			disband_event_forces = call_to_glory_rowdy
			set_variable = { which = "call_to_glory_variable" value = 0 }
			break = yes
		}
	}

	option = { #Inspire with combat rating.
		name = EVTOPTAHF25033
		trigger = { combat_rating = 50 ai = no }
		tooltip_info = combat_rating
		custom_tooltip = { text = tooltip_call_to_glory_resume_reinforcements }
		hidden_tooltip = { change_variable = { which = "call_to_glory_variable" value = -10 } }
		hidden_tooltip = { 
			character_event = { id = HF.25031 days = 45 random = 5 } #Hidden random list.
		}

	}
	option = { #Bribe them.
		name = EVTOPTBHF25033
		trigger = { ai = no }
		if = { 
			limit = { ai = no }
			scaled_wealth = { value = -1.0 min = -150 max = -250 } 
		}
		custom_tooltip = { text = tooltip_call_to_glory_resume_reinforcements }
		hidden_tooltip = { change_variable = { which = "call_to_glory_variable" value = -10 } }
		hidden_tooltip = { 
			character_event = { id = HF.25031 days = 45 random = 5 } #Hidden random list.
		}

	}
	option = { #Do nothing - No more reinforcements.
		name = EVTOPTCHF25033
		custom_tooltip = { text = tooltip_call_to_glory_end_reinforcements }
		hidden_tooltip = { set_variable = { which = "call_to_glory_variable" value = 0 } }
	}
}


#Rowdy Troops demand a greater share of the loot or they will leave.
character_event = {
	id = HF.25034
	desc = EVTDESCHF25034
	picture = GFX_evt_viking_battle_oldgods
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	trigger = { 
		has_character_modifier = call_to_glory
		war = yes
		is_member_of_any_warrior_lodge_trigger = yes
		society_rank = 4
		NOT = { check_variable = { which = "call_to_glory_variable" value = 20 } }
	}

	fail_trigger_effect = { 
		if = { 
			limit = { 
				OR = { 
					is_member_of_any_warrior_lodge_trigger = no
					war = no 
					AND = {
						is_member_of_any_warrior_lodge_trigger = yes
						NOT = { society_rank = 4 }
					}
					NOT = { has_character_modifier = call_to_glory }
				}
			}
			#If basic requirements for the power are no longer met, clean everything and stop the chain.
			remove_character_modifier = call_to_glory
			disband_event_forces = call_to_glory_disciplined
			disband_event_forces = call_to_glory_rowdy
			set_variable = { which = "call_to_glory_variable" value = 0 }
			break = yes
		}
	}

	option = { #Use diplomacy.
		name = EVTOPTAHF25034
		trigger = { ai = no diplomacy = 20 }
		tooltip_info = diplomacy
		
	}
	option = { #Bribe them.
		name = EVTOPTBHF25034
		trigger = { ai = no }
		if = { 
			limit = { ai = no }
			scaled_wealth = { value = -0.8 min = -50 max = -150 } 
		}

	}
	option = { #Let all rowdy troops go.
		name = EVTOPTCHF25034
		custom_tooltip = { text = tooltip_rowdy_troops_leave }
		hidden_tooltip = { disband_event_forces = call_to_glory_rowdy }
		hidden_tooltip = { change_variable = { which = "call_to_glory_variable" value = -3 } }
	}
	after = { 
		hidden_tooltip = { 
			character_event = { id = HF.25031 days = 25 random = 5 } #Hidden random list.
		}
	}
}

#Surplus manpower. How to use? Chance for either levy reinforcement bonus in capital, prestige, cheap troops, or raider ships.
character_event = {
	id = HF.25037
	desc = EVTDESCHF25037
	picture = GFX_evt_viking_battle_oldgods
	border = GFX_event_normal_frame_war

	is_triggered_only = yes

	trigger = { 
		has_character_modifier = call_to_glory
		war = yes
		is_member_of_any_warrior_lodge_trigger = yes
		society_rank = 4
		NOT = { check_variable = { which = "call_to_glory_variable" value = 20 } }
	}

	fail_trigger_effect = { 
		if = { 
			limit = { 
				OR = { 
					is_member_of_any_warrior_lodge_trigger = no
					war = no 
					AND = {
						is_member_of_any_warrior_lodge_trigger = yes
						NOT = { society_rank = 4 }
					}
					NOT = { has_character_modifier = call_to_glory }
				}
			}
			#If basic requirements for the power are no longer met, clean everything and stop the chain.
			remove_character_modifier = call_to_glory
			disband_event_forces = call_to_glory_disciplined
			disband_event_forces = call_to_glory_rowdy
			set_variable = { which = "call_to_glory_variable" value = 0 }
			break = yes
		}
	}

	option = { #Capital levy reinforcement rate/manpower.
		name = EVTOPTAHF25037
		if = { 
			limit = { is_nomadic = yes }
			manpower = 200
		}
		if = { 
			limit = { is_nomadic = no }
			any_demesne_province = { 
				add_province_modifier = { name = capital_call_to_glory duration = 150 stacking = yes } 
			}
		}
	}

	option = { #Bonus Prestige.
		name = EVTOPTBHF25037
		prestige = 150
	}
	option = { #Bonus infantry.
		name = EVTOPTCHF25037
        capital_scope = {
        	show_scope_change = no 
        	ROOT = { 
        	hidden_tooltip = { change_variable = { which = "call_to_glory_variable" value = 1 } }
	        	show_scope_change = no
       			spawn_unit = { 
                    province = PREV
                    owner = ROOT
                    troops = { 
                  		light_infantry = { 400 400 }
                    }
                    earmark = call_to_glory_rowdy
                    attrition = 0
			        merge = yes
                    maintenance_multiplier = 0
	               disband_on_peace = yes
	           	}
	       	}
       	}
	}
	option = { #Bonus ships.
		name = EVTOPTDHF25037
		spawn_fleet = {
			province = closest # closest sea zone
			owner = ROOT
			disband_on_peace = yes
			troops = {
				galleys = { 50 50 }
			}
			earmark = call_to_glory_rowdy
		}
	}
	after = { 
		hidden_tooltip = { 
			character_event = { id = HF.25031 days = 45 random = 5 } #Hidden random list.
		}
	}
}

#On war over/leave_society, remove call_to_glory modifier.
character_event = {
	id = HF.25035
	hide_window = yes

	is_triggered_only = yes

	trigger = {
		OR = {
			ROOT = {
				has_character_modifier = call_to_glory
			}
			ROOT = {
				has_character_modifier = call_to_glory
			}
		}
	}
	immediate = { 
		ROOT = { character_event = { id = HF.25036 days = 1 } } #One day delay to check for any other wars.
		FROM = { character_event = { id = HF.25036 days = 1 } } #One day delay to check for any other wars.
	}
}
character_event = {
	id = HF.25036
	hide_window = yes

	is_triggered_only = yes

	immediate = { 
		ROOT = { 
			if = { 
			limit = { 
				has_character_modifier = call_to_glory
					OR = { 
						war = no 
						is_member_of_any_warrior_lodge_trigger = no
						AND = { #Switched to another Warrior Lodge.
							is_member_of_any_warrior_lodge_trigger = yes
							NOT = { society_rank = 4 }
						}
					}
				}
				remove_character_modifier = call_to_glory
				disband_event_forces = call_to_glory_disciplined
				disband_event_forces = call_to_glory_rowdy
				set_variable = { which = "call_to_glory_variable" value = 0 } 
				any_demesne_province = { remove_province_modifier = capital_call_to_glory } 
			}
		}
	}
}

#####################################################
#Create Fetish Lodge Power for West-Africans.
#Decide whether you want a mask or an idol. - removed for Faerun

#Notifications for Baltic Holds Power. - removed
#on_startup event giving tattoos to Grand Masters/Veterans of the Warrior Lodges who have them.
character_event = {
	id = HF.25070
	hide_window = yes

	is_triggered_only = yes

	trigger = { 
		is_save_game = no
		society_rank = 3
		ai = yes
		is_ruler = no
		society_member_of = warrior_lodge_uthgardt
		NOR = { 
			trait = norse_tattoo_1
			trait = norse_tattoo_2
			trait = norse_tattoo_3
			trait = norse_tattoo_4
			trait = norse_tattoo_5
			trait = norse_tattoo_6
		}
	}

	immediate = { 
		if = {
			limit = { society_member_of = warrior_lodge_uthgardt }

			random_list = { 
				25 = { 
					trigger = { NOT = { society_rank = 4 } }
					add_trait = norse_tattoo_1
				}
				25 = { 
					trigger = { NOT = { society_rank = 4 } }
					add_trait = norse_tattoo_2
				}
				25 = { 
					trigger = { NOT = { society_rank = 4 } }
					add_trait = norse_tattoo_3
				}
				25 = { 
					trigger = { society_rank = 4 }
					add_trait = norse_tattoo_4
				}
				25 = { 
					trigger = { society_rank = 4 }
					add_trait = norse_tattoo_5
				}
				25 = { 
					trigger = { society_rank = 4 }
					add_trait = norse_tattoo_6
				}
			}
		}
	}
}

#Safety removal on_death and leave_society for Warriors of Ukko event troops. - removed