#Clerical spellcasting - based on faerun_tb_cle_spellbook

decisions = {

#Universal spells

	dispel_clerical = {
		ai_check_interval = 30
		potential = {
			z_cleric = yes
			OR = {
				ai = yes
				has_character_flag = cle_spellbook_open
			}
		}
		allow = {
			custom_tooltip = {
				text = HAS10SPELLPOINTS
				hidden_tooltip = {
					check_variable = { which = clespellpoints value = 10 }
				}
			}
			custom_tooltip = {
				text = HASBADSPELL
				hidden_tooltip = {
					has_bad_spell_effect = yes
				}
			}
			custom_tooltip = {
				text = SPELL_ON_COOLDOWN
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = spell_dispel_cooldown }
						had_character_flag = { flag = spell_dispel_cooldown months = 1 }
					}
				}
			}
			#NOT = { has_character_modifier = burn_path_mod }
		}
		effect = {
			hidden_tooltip = { change_variable = { which = clespellpoints value = -10 } }
			set_character_flag = spell_dispel_cooldown

			dispel_minor_magic = yes
		}
		ai_will_do = {
			factor = 0.1
		}
	}

	turn_undead = {
		ai = no
		potential = {
			#z_cleric = yes
			#OR = {
				#ai = yes
				has_character_flag = cle_spellbook_open
			#}
		}
		allow = {
			in_battle = yes
			custom_tooltip = {
				text = HAS10SPELLPOINTS #only costs 10 for clerics since they're better at turning/destroying undead
				hidden_tooltip = {
					check_variable = { which = clespellpoints value = 10 }
				}
			}
			war = yes
			any_current_enemy = {
				OR = {
					trait = undead
					trait = lich
					trait = lich_baelnorn
					trait = vampire
					trait = vampire_spawn
				}
			}
			custom_tooltip = {
				text = SPELL_ON_COOLDOWN
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = spell_disrupt_undead_cooldown }
						had_character_flag = { flag = spell_disrupt_undead_cooldown months = 1 }
					}
				}
			}

			#NOT = { has_character_modifier = burn_path_mod }
		}
		effect = {
			change_variable = { which = clespellpoints value = -10 }
			set_character_flag = spell_disrupt_undead_cooldown

			#if = {
				#limit = {
					#combat = {
						#enemy = {
							#any_controlled_unit = {
								#troops = {
									#who = undead_troops
									#value > 0
								#}
							#}
						#}
					#}
				#}
				#combat = {
					#enemy = {
						#combat = {
							#damage_unit = {
								#type = undead_troops
								#percentage = 33
							#}
							#random = {
								#chance = 33
								#damage_unit = {
									#type = undead_troops
									#percentage = 33
								#}
							#}
							#random = {
								#chance = 33
								#damage_unit = {
									#type = undead_troops
									#percentage = 33
								#}
							#}
						#}
					#}
				#}
			#}

			any_current_enemy = {
				random_realm_character = {
					limit = {
						at_location = ROOT
						in_command = yes
						prisoner = no
					}
					morale = -0.35
				}
			}
			if = {
				limit = {
					combat = {
						enemy = {
							ai = no
						}
					}
				}
				combat = {
					enemy = {
						repeat_event = { id = spellaux.3 }
					}
				}
			}
			combat = {
				enemy = {
					spell_resistance_check = yes
					if = {
						limit = {
							NOT = { has_character_modifier = disrupt_undead_mod }
						}
						add_character_modifier = {
							name = disrupt_undead_mod
							months = 2
						}
						opinion = {
							modifier = cast_spell_on_me
							who = ROOT
							years = 1
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.5
		}
	}

	planar_binding_clerical = {
		ai_check_interval = 24
		only_rulers = yes
		potential = {
			#z_cleric = yes
			OR = {
				ai = yes
				has_character_flag = cle_spellbook_open
			}
		}
		allow = {
			custom_tooltip = {
				text = HAS20SPELLPOINTS
				hidden_tooltip = {
					check_variable = { which = clespellpoints value = 20 }
				}
			}
			custom_tooltip = {
				text = EXPERTCLEHIGHER
				hidden_tooltip = {
					OR = {
						trait = expert_cleric
						trait = master_cleric
						trait = renowned_cleric
						trait = legendary_cleric
					}
				}
			}
			custom_tooltip = {
				text = SPELL_ON_COOLDOWN
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = spell_planar_binding_cooldown }
						had_character_flag = { flag = spell_planar_binding_cooldown months = 1 }
					}
				}
			}
			#NOT = { has_character_modifier = burn_path_mod }
		}
		effect = {
			set_character_flag = spell_planar_binding_cooldown
			hidden_tooltip = { change_variable = { which = clespellpoints value = -20 } }

			custom_tooltip = {
				text = OUTSIDERSUMMONED
				hidden_tooltip = {
					random_list = {
						1 = {
							modifier = {   #evil types won't summon angels
								olrox_is_evil_religion_trigger = yes
								factor = 0
							}
							#modifier = {
								#AND = {   #evil types won't summon angels
										#religion_group = drow_pantheon
										#NOT = { trait = patron_eilistraee }
								#}
								#factor = 0
							#}

							create_character = {
								age = 1000
								female = random
								trait = creature_angel
								random_traits = yes
								religion = triadic
								culture = angel
								dynasty = none
								immortal_age = 30
							}
						}
						1 = {
							create_character = {
								age = 300
								female = random
								trait = creature_genie
								random_traits = yes
								religion = ten_thousand_gods
								culture = jann
								dynasty = none
								immortal_age = 30
							}
						}
						1 = {
							modifier = { #goodly types won't summon fiends
								olrox_is_good_religion_trigger = yes
								factor = 0
							}
							#modifier = {
								#AND = {
										#religion_group = drow_pantheon
										#trait = patron_eilistraee
								#}
								#factor = 0
							#}
							create_character = {
								age = 1000
								female = random
								trait = creature_devil
								random_traits = yes
								religion = infernal
								culture = baatezu
								dynasty = none
								immortal_age = 30
							}
						}
						1 = {
							modifier = { #goodly types won't summon fiends
								olrox_is_good_religion_trigger = yes
								factor = 0
							}
							#modifier = {
								#AND = {
										#religion_group = drow_pantheon
										#trait = patron_eilistraee
								#}
								#factor = 0
							#}
							create_character = {
								age = 1000
								female = random
								trait = creature_demon
								random_traits = yes
								religion = abyssal_cult
								culture = tanarri
								dynasty = none
								immortal_age = 30
							}
						}
						1 = {
							modifier = { #goodly types won't summon fiends
								olrox_is_good_religion_trigger = yes
								factor = 0
							}
							#modifier = {
								#AND = {
										#religion_group = drow_pantheon
										#trait = patron_eilistraee
								#}
								#factor = 0
							#}
							create_character = {
								age = 1000
								female = random
								trait = creature_daemon
								random_traits = yes
								religion = shadow_gods
								culture = yugoloth
								dynasty = none
								immortal_age = 30
							}
						}
					}
					new_character = {
						opinion = {
							modifier = planar_binding_mod
							who = ROOT
							years = 10
						}
						character_event = { id = spellaux.43 years = 20 }
						if = {
							limit = {
								trait = creature_devil
							}
							random_list = {
								65 = {
									set_graphical_culture = cornugon
								}
								20 = {
									add_trait = greater_fiend
								}
								10 = {
									set_graphical_culture = gelugon
									add_trait = greater_fiend
								}
								5 = {
									set_graphical_culture = tiefling
								}
							}
						}
						else_if = {
							limit = {
								trait = creature_demon
							}
							random_list = {
								65 = {
									# do nothing - vrock gfx is correct
								}
								20 = {
									set_graphical_culture = succubus
								}
								10 = {
									set_graphical_culture = nalfeshnee
									add_trait = greater_fiend
								}
								10 = {
									set_graphical_culture = succubus
									add_trait = greater_fiend # marilith
								}
								2 = {
									set_graphical_culture = baatezu # balors look a lot like pit fiends
									add_trait = greater_fiend
								}
								2 = {
									set_graphical_culture = yugoloth # or nycaloths
									add_trait = greater_fiend
								}
								2 = {
									set_graphical_culture = cambion
								}
							}
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				has_full_court = yes
			}
		}
	}

	planar_ally = {
		ai_check_interval = 24
		only_rulers = yes
		potential = {
			#z_cleric = yes
			OR = {
				ai = yes
				has_character_flag = cle_spellbook_open
			}
		}
		allow = {
			custom_tooltip = {
				text = HAS20SPELLPOINTS
				hidden_tooltip = {
					check_variable = { which = clespellpoints value = 20 }
				}
			}
			custom_tooltip = {
				text = MASTERCLEHIGHER
				hidden_tooltip = {
					OR = {
						trait = master_cleric
						trait = renowned_cleric
						trait = legendary_cleric
					}
				}
			}
			custom_tooltip = {
				text = SPELL_ON_COOLDOWN
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = spell_greater_planar_binding_cooldown }
						had_character_flag = { flag = spell_greater_planar_binding_cooldown months = 1 }
					}
				}
			}
			#NOT = { has_character_modifier = burn_path_mod }
		}
		effect = {
			set_character_flag = spell_greater_planar_binding_cooldown
			hidden_tooltip = { change_variable = { which = clespellpoints value = -25 } }

			custom_tooltip = {
				text = OUTSIDERSUMMONED
				hidden_tooltip = {
					random_list = {
						1 = {
							modifier = {   #evil types won't summon angels
								olrox_is_evil_religion_trigger = yes
								factor = 0
							}
							#modifier = {
								#AND = {   #evil types won't summon angels
										#religion_group = drow_pantheon
										#NOT = { trait = patron_eilistraee }
								#}
								#factor = 0
							#}

							create_character = {
								age = 1000
								female = random
								trait = creature_angel
								attributes = {
									diplomacy = 8
									martial = 8
									stewardship = 8
									intrigue = 8
									learning = 8
								}
								random_traits = yes
								religion = triadic
								culture = angel
								dynasty = none
								immortal_age = 30
							}
						}
						1 = {
							create_character = {
								age = 300
								female = random
								trait = creature_genie
								attributes = {
									diplomacy = 8
									martial = 8
									stewardship = 8
									intrigue = 8
									learning = 8
								}
								random_traits = yes
								religion = ten_thousand_gods
								culture = jann
								dynasty = none
								immortal_age = 30
							}
						}
						1 = {
							modifier = { #goodly types won't summon fiends
								olrox_is_good_religion_trigger = yes
								factor = 0
							}
							#modifier = {
								#AND = {
										#religion_group = drow_pantheon
										#trait = patron_eilistraee
								#}
								#factor = 0
							#}
							create_character = {
								age = 1000
								female = random
								trait = creature_devil
								attributes = {
									diplomacy = 8
									martial = 8
									stewardship = 8
									intrigue = 8
									learning = 8
								}
								random_traits = yes
								religion = infernal
								culture = baatezu
								dynasty = none
								immortal_age = 30
							}
						}
						1 = {
							modifier = { #goodly types won't summon fiends
								olrox_is_good_religion_trigger = yes
								factor = 0
							}
							#modifier = {
								#AND = {
										#religion_group = drow_pantheon
										#trait = patron_eilistraee
								#}
								#factor = 0
							#}
							create_character = {
								age = 1000
								female = random
								trait = creature_demon
								attributes = {
									diplomacy = 8
									martial = 8
									stewardship = 8
									intrigue = 8
									learning = 8
								}
								random_traits = yes
								religion = abyssal_cult
								culture = tanarri
								dynasty = none
								immortal_age = 30
							}
						}
						1 = {
							modifier = { #goodly types won't summon fiends
								olrox_is_good_religion_trigger = yes
								factor = 0
							}
							#modifier = {
								#AND = {
										#religion_group = drow_pantheon
										#trait = patron_eilistraee
								#}
								#factor = 0
							#}
							create_character = {
								age = 1000
								female = random
								trait = creature_daemon
								attributes = {
									diplomacy = 8
									martial = 8
									stewardship = 8
									intrigue = 8
									learning = 8
								}
								random_traits = yes
								religion = shadow_gods
								culture = yugoloth
								dynasty = none
								immortal_age = 30
							}
						}
					}
					new_character = {
						opinion = {
							modifier = planar_binding_mod
							who = ROOT
							years = 10
						}
						character_event = { id = spellaux.43 years = 20 }
						if = {
							limit = {
								trait = creature_devil
							}
							random_list = {   #boosts the chances of a greater fiend
								50 = {
									add_trait = greater_fiend
								}
								25 = {
									set_graphical_culture = gelugon
									add_trait = greater_fiend
								}
							}
						}
						else_if = {
							limit = {
								trait = creature_demon
							}
							random_list = { #boosts the chances of a greater fiend
								50 = {
									set_graphical_culture = succubus
									add_trait = fair
								}
								20 = {
									set_graphical_culture = nalfeshnee
									add_trait = greater_fiend
								}
								20 = {
									set_graphical_culture = succubus
									add_trait = greater_fiend # marilith
								}
								5 = {
									set_graphical_culture = baatezu # balors look a lot like pit fiends
									add_trait = greater_fiend
								}
								5 = {
									set_graphical_culture = yugoloth # or nycaloths
									add_trait = greater_fiend
								}
							}
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				has_full_court = yes
			}
		}
	}

	spell_animate_dead_clerical = {
		only_playable = yes
		ai_check_interval = 6
		potential = {
			is_playable = yes
			z_cleric = yes
			NOT = {  #religions of deities opposed to raising the undead can't cast this
					olrox_is_good_religion_trigger = yes
			}
			OR = {
				#AND = {
					ai = yes
				#	is_ruler = yes
				#}
				has_character_flag = cle_spellbook_open
			}
		}
		allow = {
			war = yes
			custom_tooltip = {
				text = HAS12SPELLPOINTS
				hidden_tooltip = {
					check_variable = { which = clespellpoints value = 10 }
				}
			}
			custom_tooltip = {
				text = NOSUMMONEDDEMONS
				hidden_tooltip = {
					NOT = { has_earmarked_regiments = wiz_animate_dead }
				}
			}
			custom_tooltip = {
				text = SPELL_ON_COOLDOWN
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = spell_animate_dead_cooldown }
						had_character_flag = { flag = spell_animate_dead_cooldown months = 1 }
					}
				}
			}
			#NOT = { has_character_modifier = burn_path_mod }
		}
		effect = {
			set_character_flag = spell_animate_dead_cooldown
			hidden_tooltip = { change_variable = { which = clespellpoints value = -10 } }
			hidden_tooltip = {
				if = {
					limit = {
						has_character_modifier = wiz_wild
					}
					random = {
						chance = 15
						character_event = { id = spellaux.4 }
						break = yes
					}
				}
			}
			location = {
				ROOT = {
					spawn_unit = {
						province = PREV
						home = PREV
						owner = THIS
						earmark = wiz_animate_dead
						troops = {
							undead_troops = { 1000 1000 }
						}
						cannot_inherit = yes
						attrition = 0
						maintenance_multiplier = 0
						can_toggle_looting = no
						reinforces = no
					}
				}
			}
			hidden_tooltip = { character_event = { id = spellaux.37 months = 5 } }
		}
		ai_will_do = {
			factor = 1
			modifier = {
				factor = 0
				war = no
			}
		}
	}

	spell_create_undead_clerical = {
		ai_check_interval = 24
		only_rulers = yes
		potential = {
			z_cleric = yes
			NOT = {  #religions of deities opposed to raising the undead can't cast this
					olrox_is_good_religion_trigger = yes
			}
			OR = {
				ai = yes
				has_character_flag = cle_spellbook_open
			}
		}
		allow = {
			custom_tooltip = {
				text = HAS20SPELLPOINTS
				hidden_tooltip = {
					check_variable = { which = clespellpoints value = 20 }
				}
			}
			custom_tooltip = {
				text = MASTERCLEHIGHER
				hidden_tooltip = {
					OR = {
						trait = master_cleric
						trait = renowned_cleric
						trait = legendary_cleric
					}
				}
			}
			custom_tooltip = {
				text = SPELL_ON_COOLDOWN
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = spell_create_undead_cooldown }
						had_character_flag = { flag = spell_create_undead_cooldown months = 1 }
					}
				}
			}
			#NOT = { has_character_modifier = burn_path_mod }
		}
		effect = {
			set_character_flag = spell_create_undead_cooldown
			hidden_tooltip = { change_variable = { which = clespellpoints value = -20 } }
			custom_tooltip = {
				text = UNDEADSUMMONED
				hidden_tooltip = {
					create_character = {
						age = 100
						female = random
						random_traits = yes
						trait = undead
						religion = ROOT
						culture = THIS
						dynasty = none
						immortal_age = 30
					}
					new_character = {
						character_event = { id = z_character_trait.1 }
						opinion = {
							modifier = planar_binding_mod
							who = ROOT
							years = 10
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.1
			modifier = {
				factor = 0
				has_full_court = yes
			}
			modifier = {
				factor = 0
				NOR = {
					trait = vampire
					trait = lich
					trait = undead
					trait = patron_velsharoon
					trait = patron_myrkul
					trait = patron_orcus
				}
			}
		}
	}

	sunesplendor = {
		ai_check_interval = 30
		potential = {
			trait = patron_sune
			z_cleric = yes
			OR = {
				ai = yes
				has_character_flag = cle_spellbook_open
			}
		}
		allow = {
			custom_tooltip = {
				text = HAS10SPELLPOINTS
				hidden_tooltip = {
					check_variable = { which = clespellpoints value = 10 }
				}
			}
			custom_tooltip = {
				text = SPELL_ON_COOLDOWN
				hidden_tooltip = {
					OR = {
						NOT = { has_character_flag = spell_sunesplendor_cooldown }
						had_character_flag = { flag = spell_dispel_cooldown years = 10 }
					}
				}
			}
			#NOT = { has_character_modifier = burn_path_mod }
		}
		effect = {
			hidden_tooltip = { change_variable = { which = clespellpoints value = -10 } }
			set_character_flag = sunesplendor
			custom_tooltip = {
				text = BEAUTIFIED
				hidden_tooltip = {
					random_list = {
						40 = {
							modifier = {
								NOT = { trait = scarred_high }
								factor = 0
							}
							remove_trait = scarred_high
							add_trait = scarred_mid
						}
						20 = {
							modifier = {
								NOT = { trait = scarred_mid }
								factor = 0
							}
							remove_trait = scarred_mid
							add_trait = scarred
						}
						10 = {
							modifier = {
								NOT = { trait = scarred }
								factor = 0
							}
							remove_trait = scarred
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.1
		}
	}

	spell_lesser_restoration_cleric_fake = { # This is basically a reminder that you have this spell and who you can use it on
		ai = no
		ai_check_interval = 6000
		potential = {
			#ai = no
			#z_cleric = yes
			has_character_flag = cle_spellbook_open
		}

		allow = {
			always = no
		}

		effect = {
			break = yes # doesn't matter
		}

		ai_will_do = {
			factor = 0 # Just to be sure
		}
	}

	spell_heal_cleric_fake = { # This is basically a reminder that you have this spell and who you can use it on
		ai = no
		ai_check_interval = 6000
		potential = {
			#ai = no
			#z_cleric = yes
			has_character_flag = cle_spellbook_open
		}

		allow = {
			always = no
		}

		effect = {
			break = yes # doesn't matter
		}

		ai_will_do = {
			factor = 0 # Just to be sure
		}
	}

	spell_greater_restoration_cleric_fake = { # This is basically a reminder that you have this spell and who you can use it on
		ai = no
		ai_check_interval = 6000
		potential = {
			#ai = no
			#z_cleric = yes
			has_character_flag = cle_spellbook_open
		}

		allow = {
			always = no
		}

		effect = {
			break = yes # doesn't matter
		}

		ai_will_do = {
			factor = 0 # Just to be sure
		}
	}

	spell_regenerate_cleric_fake = { # This is basically a reminder that you have this spell and who you can use it on
		ai = no
		ai_check_interval = 6000
		potential = {
			#ai = no
			#z_cleric = yes
			has_character_flag = cle_spellbook_open
		}

		allow = {
			always = no
		}

		effect = {
			break = yes # doesn't matter
		}

		ai_will_do = {
			factor = 0 # Just to be sure
		}
	}

}


targeted_decisions = {

#Universal spells

	spell_banish_clerical = {
		ai_check_interval = 6
		filter = rivals
		ai_target_filter = rivals

		from_potential = {
			z_cleric = yes
		}

		potential = {
			at_location = FROM
			OR = {
				trait = creature_angel
				trait = creature_demon
				trait = creature_devil
				trait = creature_daemon
			}
		}

		allow = {
			FROM = {
				#at_location = ROOT
				custom_tooltip = {
					text = HAS20SPELLPOINTS
					hidden_tooltip = {
						check_variable = { which = clespellpoints value = 20 }
					}
				}
				custom_tooltip = {
					text = JOURNEYMANCLEHIGHER
					hidden_tooltip = {
						OR = {
							trait = journeyman_cleric
							trait = expert_cleric
							trait = master_cleric
							trait = renowned_cleric
							trait = legendary_cleric
						}
					}
				}
				custom_tooltip = {
					text = SPELL_ON_COOLDOWN
					hidden_tooltip = {
						OR = {
							NOT = { has_character_flag = spell_banish_cooldown }
							had_character_flag = { flag = spell_banish_cooldown months = 1 }
						}
					}
				}
				#NOT = { has_character_modifier = burn_path_mod }
			}
		}

		effect = {
			FROM = { set_character_flag = spell_banish_cooldown }
			FROM = { hidden_tooltip = { change_variable = { which = clespellpoints value = -20 } } }
			hidden_tooltip = {
				FROM = {
					if = {
						limit = {
							has_character_modifier = wiz_wild
						}
						random = {
							chance = 15
							character_event = { id = spellaux.4 }
							break = yes
						}
					}
				}
			}
			spell_resistance_check = yes
			death = { death_reason = death_banished_spell killer = FROM }
			if = {
				limit = {
					ai = no
				}
				FROM = {
					ROOT = {
						character_event = { id = spellaux.5 }
					}
				}
			}
			opinion = {
				modifier = cast_spell_on_me
				who = FROM
				years = 1
			}
		}
		ai_will_do = {
			factor = 0.2
		}
	}


	spell_lesser_restoration = {
		ai = no
		ai_check_interval = 6000
		filter = realm_including_me
		ai_target_filter = none #ai has its own version

		from_potential = {
			ai = no
			z_cleric = yes
		}
		potential = {
			OR = {
				trait = ill
				trait = sickly
				character_disease_trigger = yes
			}
			NOR = { #if it's this bad they need greater restoration
				trait = incapable
				trait = sick_incapable
			}
		}
		allow = {
			FROM = {
				custom_tooltip = {
					text = HAS10SPELLPOINTS
					hidden_tooltip = {
						check_variable = { which = clespellpoints value = 10 }
					}
				}
				custom_tooltip = {
					text = JOURNEYMANCLEHIGHER
					hidden_tooltip = {
						OR = {
							trait = journeyman_cleric
							trait = expert_cleric
							trait = master_cleric
							trait = renowned_cleric
							trait = legendary_cleric
						}
					}
				}
				custom_tooltip = {
					text = SPELL_ON_COOLDOWN
					hidden_tooltip = {
						OR = {
							NOT = { has_character_flag = spell_remove_disease_cooldown }
							had_character_flag = { flag = spell_remove_disease_cooldown months = 1 }
						}
					}
				}
				#NOT = { has_character_modifier = burn_path_mod }
			}
		}
		effect = {
			FROM = { set_character_flag = spell_remove_disease_cooldown }
			FROM = { hidden_tooltip = { change_variable = { which = clespellpoints value = -10 } } }
			hidden_tooltip = {
				if = {
					limit = {
						NOT = { character = FROM }
					}
					opinion = {
						modifier = cured_me
						who = FROM
						years = 5
					}
					if = {
						limit = {
							ai = no
						}
						repeat_event = { id = spellaux.7 }
					}
				}
				else_if = {
					limit = {
						ai = no
						character = FROM
					}
					character_event = { id = spellaux.8 }
				}
			}
			custom_tooltip = {
				text = ONEDISEASECURED
				hidden_tooltip = {
					remove_trait = sickly
					remove_character_modifier = mild_illness
					remove_character_modifier = severe_illness
					remove_character_modifier = bedridden_illness
					#remove treatments
					remove_character_modifier = mystic_treatment_decent
					remove_character_modifier = mystic_treatment_poor
					remove_character_modifier = mystic_treatment_terrible
					remove_character_modifier = symptom_treatment_1
					remove_character_modifier = symptom_treatment_2
					remove_character_modifier = symptom_treatment_3
					remove_character_modifier = symptom_treatment_4
					remove_character_modifier = successful_treatment_1
					remove_character_modifier = successful_treatment_2
					remove_character_modifier = successful_treatment_3
					remove_character_modifier = failed_treatment_1
					remove_character_modifier = failed_treatment_2
					if = {
						limit = {
							NOT = { has_dlc = "Reapers" }
						}
						remove_trait = ill
					}
					else_if = {
						limit = {
							has_dlc = "Reapers"
						}
						random_list = {
							40 = {
								modifier = {
									NOT = { trait = flu }
									factor = 0
								}
								remove_trait = flu
								clr_character_flag = manifest_flu
							}
							20 = {
								modifier = {
									NOT = { trait = dysentery }
									factor = 0
								}
								remove_trait = dysentery
							}
							10 = {
								modifier = {
									NOT = { trait = rabies }
									factor = 0
								}
								remove_trait = rabies
							}
							20 = {
								modifier = {
									NOT = { trait = has_measles }
									factor = 0
								}
								remove_trait = has_measles
							}
							40 = {
								modifier = {
									NOT = {
										trait = food_poisoning
									}
									factor = 0
								}
								remove_trait = food_poisoning
							}
							20 = {
								modifier = {
									NOT = { trait = gout }
									factor = 0
								}
								remove_trait = gout
							}
							40 = {
								modifier = {
									NOT = { trait = scurvy }
									factor = 0
								}
								remove_trait = scurvy
							}
							20 = {
								modifier = {
									NOT = { trait = lovers_pox }
									factor = 0
								}
								remove_trait = lovers_pox
							}
							5 = {
								modifier = {
									NOT = { trait = cancer }
									factor = 0
								}
								remove_trait = cancer
							}
							10 = {
								modifier = {
									NOT = { trait = pneumonic }
									factor = 0
								}
								remove_trait = pneumonic
							}
							10 = {
								modifier = {
									NOT = { trait = syphilitic }
									factor = 0
								}
								remove_trait = syphilitic
							}
							5 = {
								modifier = {
									NOT = { trait = leper }
									factor = 0
								}
								remove_trait = leper
							}
							10 = {
								modifier = {
									NOT = { trait = has_tuberculosis}
									factor = 0
								}
								remove_trait = has_tuberculosis
							}
							10 = {
								modifier = {
									NOT = { trait = has_aztec_disease}
									factor = 0
								}
								remove_trait = has_aztec_disease
							}
							10 = {
								modifier = {
									NOT = { trait = has_small_pox}
									factor = 0
								}
								remove_trait = has_small_pox
							}
							10 = {
								modifier = {
									NOT = { trait = has_bubonic_plague}
									factor = 0
								}
								remove_trait = has_bubonic_plague
							}
							10 = {
								modifier = {
									NOT = { trait = has_typhus}
									factor = 0
								}
								remove_trait = has_typhus
							}
							10 = {
								modifier = {
									NOT = { trait = has_typhoid_fever}
									factor = 0
								}
								remove_trait = has_typhoid_fever
							}
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.3
			modifier = {
				factor = 100
				character = ROOT
			}
			modifier = {
				factor = 0
				is_foe = ROOT
			}
			modifier = {
				factor = 10
				trait = kind
			}
			modifier = {
				factor = 10
				is_friend = ROOT
			}
			modifier = {
				factor = 10
				opinion = {
					who = ROOT
					value = 50
				}
			}
			modifier = {
				factor = 0.5
				trait = envious
			}
			modifier = {
				factor = 0.5
				trait = slothful
			}
			modifier = {
				factor = 0.1
				OR = {
					trait = cruel
					trait = impaler
				}
			}
			modifier = {
				factor = 0.01
				trait = patron_talona
			}
		}
	}


	spell_greater_restoration = {
		ai = no
		ai_check_interval = 6000
		filter = realm_including_me
		ai_target_filter = none #ai has its own version

		from_potential = {
			ai = no
			z_cleric = yes
		}
		potential = {
			OR = {
				trait = ill
				trait = sickly
				character_disease_trigger = yes
			}
		}
		allow = {
			FROM = {
				custom_tooltip = {
					text = HAS15SPELLPOINTS
					hidden_tooltip = {
						check_variable = { which = clespellpoints value = 15 }
					}
				}
				custom_tooltip = {
					text = MASTERCLEHIGHER
					hidden_tooltip = {
						OR = {
							trait = master_cleric
							trait = renowned_cleric
							trait = legendary_cleric
						}
					}
				}
				custom_tooltip = {
					text = SPELL_ON_COOLDOWN
					hidden_tooltip = {
						OR = {
							NOT = { has_character_flag = spell_remove_disease_cooldown }
							had_character_flag = { flag = spell_remove_disease_cooldown months = 1 }
						}
					}
				}
				#NOT = { has_character_modifier = burn_path_mod }
			}
		}
		effect = {
			FROM = { set_character_flag = spell_remove_disease_cooldown }
			FROM = { hidden_tooltip = { change_variable = { which = clespellpoints value = -10 } } }
			hidden_tooltip = {
				if = {
					limit = {
						NOT = { character = FROM }
					}
					opinion = {
						modifier = cured_me
						who = FROM
						years = 5
					}
					if = {
						limit = {
							ai = no
						}
						repeat_event = { id = spellaux.7 }
					}
				}
				else_if = {
					limit = {
						ai = no
						character = FROM
					}
					character_event = { id = spellaux.8 }
				}
			}
			custom_tooltip = {
				text = ALLDISEASECURED
				hidden_tooltip = {
					remove_trait = sickly
					if = {
						limit = {
							NOT = { has_dlc = "Reapers" }
						}
						remove_trait = ill
					}
					else_if = {
						limit = {
							has_dlc = "Reapers"
						}
						#Greater restoration clears every disease
						remove_trait = flu
						remove_trait = dysentery
						remove_trait = rabies
						remove_trait = has_measles
						remove_trait = food_poisoning
						remove_trait = gout
						remove_trait = scurvy
						remove_trait = lovers_pox
						remove_trait = cancer
						remove_trait = pneumonic
						remove_trait = syphilitic
						remove_trait = leper
						remove_trait = has_tuberculosis
						remove_trait = has_aztec_disease
						remove_trait = has_small_pox
						remove_trait = has_bubonic_plague
						remove_trait = has_typhus
						remove_trait = has_typhoid_fever
						#We also remove any symptoms even if they haven't developed into disease yet
						remove_trait = abdominal_pain
						remove_trait = chest_pain
						remove_trait = cough
						remove_trait = cramps
						remove_trait = diarrhea
						remove_trait = fatigue
						remove_trait = fever
						remove_trait = headache
						remove_trait = infection
						remove_trait = malaise
						remove_trait = rash
						remove_trait = vomiting
						#also clear the flags so they don't keep getting sick
						clr_character_flag = developing_illness
						clr_character_flag = got_flu
						clr_character_flag = manifest_flu
						remove_character_modifier = mild_illness
						remove_character_modifier = severe_illness
						remove_character_modifier = bedridden_illness
						#remove treatments
						remove_character_modifier = mystic_treatment_decent
						remove_character_modifier = mystic_treatment_poor
						remove_character_modifier = mystic_treatment_terrible
						remove_character_modifier = symptom_treatment_1
						remove_character_modifier = symptom_treatment_2
						remove_character_modifier = symptom_treatment_3
						remove_character_modifier = symptom_treatment_4
						remove_character_modifier = successful_treatment_1
						remove_character_modifier = successful_treatment_2
						remove_character_modifier = successful_treatment_3
						remove_character_modifier = failed_treatment_1
						remove_character_modifier = failed_treatment_2
						#lastly remove incapable
						remove_trait = incapable
						remove_trait = sick_incapable
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.3
			modifier = {
				factor = 100
				character = ROOT
			}
			modifier = {
				factor = 0
				is_foe = ROOT
			}
			modifier = {
				factor = 10
				trait = kind
			}
			modifier = {
				factor = 10
				is_friend = ROOT
			}
			modifier = {
				factor = 10
				opinion = {
					who = ROOT
					value = 50
				}
			}
			modifier = {
				factor = 0.5
				trait = envious
			}
			modifier = {
				factor = 0.5
				trait = slothful
			}
			modifier = {
				factor = 0.1
				OR = {
					trait = cruel
					trait = impaler
				}
			}
			modifier = {
				factor = 0.01
				trait = patron_talona
			}
		}
	}

	spell_heal = {
		ai = no
		ai_check_interval = 6000
		filter = realm_including_me
		ai_target_filter = none

		from_potential = {
			z_cleric = yes
		}
		potential = {
			OR = {
				trait = wounded
				trait = mangled
				trait = severely_injured
			}
		}
		allow = {
			FROM = {
				custom_tooltip = {
					text = HAS15SPELLPOINTS
					hidden_tooltip = {
						check_variable = { which = clespellpoints value = 15 }
					}
				}
				custom_tooltip = {
					text = EXPERTCLEHIGHER
					hidden_tooltip = {
						OR = {
							trait = expert_cleric
							trait = master_cleric
							trait = renowned_cleric
							trait = legendary_cleric
						}
					}
				}
				custom_tooltip = {
					text = SPELL_ON_COOLDOWN
					hidden_tooltip = {
						OR = {
							NOT = { has_character_flag = spell_healing_cooldown }
							had_character_flag = { flag = spell_healing_cooldown months = 1 }
						}
					}
				}
				#NOT = { has_character_modifier = burn_path_mod }
			}
		}
		effect = {
			FROM = { set_character_flag = spell_healing_cooldown }
			FROM = { hidden_tooltip = { change_variable = { which = clespellpoints value = -15 } } }
			hidden_tooltip = {
				if = {
					limit = {
						NOT = { character = FROM }
					}
					opinion = {
						modifier = cured_me
						who = FROM
						years = 5
					}
					if = {
						limit = {
							ai = no
						}
						repeat_event = { id = spellaux.7 }
					}
				}
				else_if = {
					limit = {
						ai = no
						character = FROM
					}
					character_event = { id = spellaux.8 }
				}
			}
			custom_tooltip = {
				text = ALLINJURIESCURED
				hidden_tooltip = {
					remove_trait = wounded
					remove_trait = mangled
					remove_trait = severely_injured
				}
			}
		}
		ai_will_do = {
			factor = 0.3
			modifier = {
				factor = 100
				character = ROOT
			}
			modifier = {
				factor = 0
				is_foe = ROOT
			}
			modifier = {
				factor = 10
				trait = kind
			}
			modifier = {
				factor = 10
				is_friend = ROOT
			}
			modifier = {
				factor = 10
				opinion = {
					who = ROOT
					value = 50
				}
			}
			modifier = {
				factor = 0.5
				trait = envious
			}
			modifier = {
				factor = 0.5
				trait = slothful
			}
			modifier = {
				factor = 0.1
				OR = {
					trait = cruel
					trait = impaler
				}
			}

		}
	}

	spell_regenerate = {
		ai = no
		ai_check_interval = 6000
		filter = realm_including_me
		ai_target_filter = none

		from_potential = {
			z_cleric = yes
		}
		potential = {
			OR = {
				trait = wounded
				trait = mangled
				trait = severely_injured
				trait = disfigured
				trait = one_eyed
				trait = one_handed
				trait = one_legged
			}
		}
		allow = {
			FROM = {
				custom_tooltip = {
					text = HAS30SPELLPOINTS
					hidden_tooltip = {
						check_variable = { which = clespellpoints value = 30 }
					}
				}
				custom_tooltip = {
					text = REKNOWNEDCLEHIGHER
					hidden_tooltip = {
						OR = {
							trait = renowned_cleric
							trait = legendary_cleric
						}
					}
				}
				custom_tooltip = {
					text = SPELL_ON_COOLDOWN
					hidden_tooltip = {
						OR = {
							NOT = { has_character_flag = spell_healing_cooldown }
							had_character_flag = { flag = spell_healing_cooldown months = 1 }
						}
					}
				}
				#NOT = { has_character_modifier = burn_path_mod }
			}
		}
		effect = {
			FROM = { set_character_flag = spell_healing_cooldown }
			FROM = { hidden_tooltip = { change_variable = { which = clespellpoints value = -30 } } }
			hidden_tooltip = {
				if = {
					limit = {
						NOT = { character = FROM }
					}
					opinion = {
						modifier = cured_me
						who = FROM
						years = 5
					}
					if = {
						limit = {
							ai = no
						}
						repeat_event = { id = spellaux.7 }
					}
				}
				else_if = {
					limit = {
						ai = no
						character = FROM
					}
					character_event = { id = spellaux.8 }
				}
			}
			custom_tooltip = {
				text = ALLREGENERATED
				hidden_tooltip = {
					remove_trait = wounded
					remove_trait = mangled
					remove_trait = severely_injured
					remove_trait = one_eyed
					remove_trait = disfigured
					remove_trait = one_legged
					remove_trait = one_handed
				}
			}
		}
		ai_will_do = {
			factor = 0.3
			modifier = {
				factor = 1000
				character = ROOT
			}
			modifier = {
				factor = 0
				is_foe = ROOT
			}
			modifier = {
				factor = 10
				trait = kind
			}
			modifier = {
				factor = 10
				is_friend = ROOT
			}
			modifier = {
				factor = 10
				opinion = {
					who = ROOT
					value = 50
				}
			}
			modifier = {
				factor = 0.5
				trait = envious
			}
			modifier = {
				factor = 0.5
				trait = slothful
			}
			modifier = {
				factor = 0.1
				OR = {
					trait = cruel
					trait = impaler
				}
			}
		}
	}
}

settlement_decisions = {



	spell_restoration_prov = {
		ai_check_interval = 6
		filter = realm_owned
		ai_target_filter = realm_owned

		from_potential = {
			z_cleric = yes
		}
		potential = {
			location = { has_disease = yes }
		}
		allow = {
			FROM = {
				NOT = { has_character_modifier = burn_path_mod }
				custom_tooltip = {
					text = HAS20SPELLPOINTS
					hidden_tooltip = {
						check_variable = { which = clespellpoints value = 20 }
					}
				}
				custom_tooltip = {
					text = EXPERTCLEHIGHER
					hidden_tooltip = {
						OR = {
							trait = expert_cleric
							trait = master_cleric
							trait = renowned_cleric
							trait = legendary_cleric
						}
					}
				}
				custom_tooltip = {
					text = SPELL_ON_COOLDOWN
					hidden_tooltip = {
						OR = {
							NOT = { has_character_flag = spell_remove_disease_cooldown }
							had_character_flag = { flag = spell_remove_disease_cooldown months = 1 }
						}
					}
				}
			}
		}
		effect = {
			FROM = { set_character_flag = spell_remove_disease_cooldown }
			FROM = { hidden_tooltip = { change_variable = { which = clespellpoints value = -20 } } }

			random_list = {
				1 = {
					location = {
						reduce_disease = -1.0 # *should* remove it completely
					}
					hidden_tooltip = {
						if = {
							limit = {
								location = {
									holder_scope = {
										NOT = { character = FROM }
									}
								}
							}
							location = {
								holder_scope = {
									opinion = {
										modifier = cured_my_lands
										who = FROM
										years = 5
									}
									if = {
										limit = {
											ai = no
										}
										repeat_event = { id = spellaux.9 }
									}
								}
							}
						}
						else_if = {
							limit = {
								location = {
									holder_scope = {
										ai = no
										character = FROM
									}
								}
							}
							location = {
								FROM = { character_event = { id = spellaux.10 } }
							}
						}
					}
				}
				1 = {
					FROM = {
						if = {
							limit = {
								ai = no
							}
							character_event = { id = spellaux.11 }
						}
					}
				}
			}
		}
		ai_will_do = {
			factor = 0.3
			modifier = {
				factor = 100
				location = {
					holder_scope = {
						character = ROOT
					}
				}
			}
			modifier = {
				factor = 0
				location = {
					holder_scope = {
						is_foe = FROM
					}
				}
			}
			modifier = {
				factor = 10
				FROM = { trait = kind }
			}
			modifier = {
				factor = 10
				location = {
					holder_scope = {
						is_friend = FROM
					}
				}
			}
			modifier = {
				factor = 10
				location = {
					holder_scope = {
						opinion = {
							who = FROM
							value = 50
						}
					}
				}
			}
			modifier = {
				factor = 0.5
				FROM = { trait = envious }
			}
			modifier = {
				factor = 0.5
				FROM = { trait = slothful }
			}
			modifier = {
				factor = 0.1
				FROM = {
					OR = {
						trait = cruel
						trait = impaler
					}
				}
			}
			modifier = {
				factor = 0.1
				FROM = { trait = patron_talona }
			}
		}
	}

	#spell_animate_dead_clerical_prov = {
		#ai_check_interval = 10
		#filter = realm_owned
		#ai_target_filter = realm_owned

		#from_potential = {
			#z_cleric = yes
			#NOT = {  #religions of deities opposed to raising the undead can't cast this
					#religion_group = good_human_pantheon_group
					#religion_group = elven_pantheon_group
					#religion = dwarven_pantheon
					#religion = gnome_pantheon
					#religion = bahamut
					#religion = adama
			#}
		#}
		#potential = {
			#location = {
				#holder_scope = {
					#character = FROM
				#}
			#}
		#}
		#allow = {
			#location = {
				#NOT = { has_province_modifier = empty_graves_mod }
			#}
			#FROM = {
				#NOT = { has_character_modifier = burn_path_mod }
				#custom_tooltip = {
					#text = EXPERTCLEHIGHER
					#hidden_tooltip = {
						#OR = {
							#trait = expert_cleric
							#trait = master_cleric
							#trait = renowned_cleric
							#trait = legendary_cleric
						#}
					#}
				#}
				#custom_tooltip = {
					#text = HAS12SPELLPOINTS
					#hidden_tooltip = {
						#check_variable = { which = clespellpoints value = 12 }
					#}
				#}
				#custom_tooltip = {
					#text = SPELL_ON_COOLDOWN
					#hidden_tooltip = {
						#OR = {
							#NOT = { has_character_flag = spell_animate_dead_cooldown }
							#had_character_flag = { flag = spell_animate_dead_cooldown months = 1 }
						#}
					#}
				#}
			#}
		#}
		#effect = {
			#FROM = { set_character_flag = spell_animate_dead_cooldown }
			#FROM = { hidden_tooltip = { change_variable = { which = clespellpoints value = -12 } } }
			#hidden_tooltip = {
				#FROM = {
					#if = {
						#limit = {
							#has_character_modifier = wiz_wild
						#}
						#random = {
							#chance = 15
							#character_event = { id = spellaux.4 }
							#break = yes
						#}
					#}
				#}
			#}
			#location = {
				#FROM = {
					#spawn_unit = {
						#province = PREV
						#home = PREV
						#owner = FROM
						#troops = {
							#undead_troops = { 100 100 }
						#}
						#scaled_by_biggest_garrison = 1
						#cannot_inherit = yes
						#attrition = 0.1
						#can_toggle_looting = no
						#reinforces = no
					#}
				#}
			#}
			#location = {
				#add_province_modifier = {
					#name = empty_graves_mod
					#years = 3
				#}
				#if = {
					#limit = {
						#NOT = {
							#has_province_modifier = undead_province
						#}
					#}
					#add_province_modifier = {
						#name = raised_dead_in_prov
						#years = 3
					#}
				#}
			#}
		#}
		#ai_will_do = {
			#factor = 0.5
			#modifier = {
				#factor = 0
				#FROM = { NOT = { wealth = 100 } }
			#}
			#modifier = {
				#factor = 10
				#FROM = { trait = diligent }
			#}
			#modifier = {
				#factor = 0.5
				#FROM = { trait = slothful }
			#}
			#modifier = {
				#factor = 20
				#FROM = { trait = patron_velsharoon }
			#}
			#modifier = {
				#factor = 20
				#FROM = {
					#OR = {
						#trait = undead
						#trait = vampire
						#trait = vampire_spawn
						#trait = lich
					#}
				#}
			#}
		#}
	#}

}
